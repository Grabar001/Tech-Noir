{% extends 'base.html.twig' %}

{% block title %}
	{{ categorie.nom }}
	| Catalogue
{% endblock %}

{% block stylesheets %}
	{{ parent() }}
	{{ encore_entry_link_tags('catalog') }}
{% endblock %}

{% block javascripts %}
	{{ parent() }}
	{{ encore_entry_script_tags('catalog') }}
{% endblock %}

{% block body %}
	<div class="catalog-page">

		<nav class="breadcrumb">
			<a href="{{ path('catalog_all') }}">Accueil</a>
			/
			<span>{{ categorie.nom }}</span>
		</nav>

		<div
			class="catalog-layout">
			{# ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë LEFT FILTER PANEL ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë #}
			<aside class="filter-panel">
				<form method="get">
					<h3>Filtres</h3>
					{% for filtre in filtres %}
						<div class="filter-group">
							<h4>{{ filtre.nom }}</h4>
							{% for valeur in filtre.filtreValeurs %}
								<label class="filter-option">
									<input type="checkbox" name="filter_{{ filtre.id }}[]" value="{{ valeur.valeur }}" id="valeur_{{ valeur.id }}" {% if valeur.valeur in app.request.get('filter_' ~ filtre.id)|default([]) %} checked {% endif %}>
									{{ valeur.valeur }}
								</label>
							{% endfor %}
						</div>
					{% endfor %}
					<button type="submit" class="btn-filter">Filtrer</button>
				</form>
			</aside>

			{# ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë RIGHT PRODUCT PANEL ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë #}
			<main class="product-panel">
				<div class="top-bar">
					<h2>{{ categorie.nom }}</h2>

					<div class="sort-select">
						<form method="get" class="sort-form">
							<label for="sort">Trier par :</label>
							<select name="sort" id="sort" onchange="this.form.submit()">
								<option value="">Par d√©faut</option>
								<option value="reduction_desc" {% if app.request.get('sort') == 'reduction_desc' %} selected {% endif %}>R√©duction ‚Üì</option>
								<option value="reduction_asc" {% if app.request.get('sort') == 'reduction_asc' %} selected {% endif %}>R√©duction ‚Üë</option>
								<option value="prix_asc" {% if app.request.get('sort') == 'prix_asc' %} selected {% endif %}>Prix ‚Üë</option>
								<option value="prix_desc" {% if app.request.get('sort') == 'prix_desc' %} selected {% endif %}>Prix ‚Üì</option>
								<option value="nom_asc" {% if app.request.get('sort') == 'nom_asc' %} selected {% endif %}>Nom A ‚Üí Z</option>
								<option value="nom_desc" {% if app.request.get('sort') == 'nom_desc' %} selected {% endif %}>Nom Z ‚Üí A</option>
								<option value="stock" {% if app.request.get('sort') == 'stock' %} selected {% endif %}>Disponibilit√© : En stock</option>
								<option value="rupture" {% if app.request.get('sort') == 'rupture' %} selected {% endif %}>Disponibilit√© : Rupture</option>
							</select>

							{# üõë –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ #}
							{% for key, value in app.request.query.all %}
								{% if key starts with 'filter_' %}
									{% for val in value %}
										<input type="hidden" name="{{ key }}[]" value="{{ val }}">
									{% endfor %}
								{% endif %}
							{% endfor %}
						</form>
					</div>

					<div class="view-toggle">
						<a href="#" class="toggle-btn grid">‚ñ¶</a>
						<a href="#" class="toggle-btn list">‚ò∞</a>
					</div>
				</div>

				<div class="products products-grid" id="product-container">
					{% for produit in produits %}
						<div class="product-card card">
							{% if produit.reduction %}
								<div class="badge discount">-{{ produit.reduction }}%</div>
							{% endif %}
							{% if produit.isNew %}
								<div class="badge new">NEW</div>
							{% endif %}

							<img src="{{ asset('images/uploads/produits/' ~ produit.image) }}" alt="{{ produit.nom }}">

							<div class="product-info">
								<h4>{{ produit.nom }}</h4>

								<p class="description">
									{{ produit.description }}
								</p>


								{% if produit.reduction %}
									<p class="old-price">
										{{ produit.prix|number_format(2, ',', ' ') }}
										‚Ç¨
									</p>
								{% endif %}

								<p class="new-price">
									{{ produit.prixAvecReduction|number_format(2, ',', ' ') }}
									‚Ç¨
								</p>

								<p class="stock">
									{% if produit.enStock %}
										‚úÖ En stock
									{% else %}
										‚ùå Rupture
									{% endif %}
								</p>
							</div>

							<form action="{{ path('cart_add', {'id': produit.id}) }}" method="post">
								<button type="submit" class="btn-add">Ajouter au panier</button>
							</form>
						</div>
					{% else %}
						<p class="no-products">Aucun produit trouv√©.</p>
					{% endfor %}
				</div>
			</main>
		</div>
	</div>
{% endblock %}
